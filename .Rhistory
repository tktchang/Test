as.data.frame
newdata1
peake.grid = with(peake, list(RATIO = seq(min(log(AREA), na.rm=TRUE), max(AREA,na.rm=TRUE), len=100)))
peake.grid = with(peake, list(RATIO = seq(min(log(AREA), na.rm=TRUE), max(log(AREA),na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq(min(AREA), na.rm=TRUE), max(AREA),na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq(min(AREA), na.rm=TRUE), max(AREA),na.rm=TRUE), len=100))
peake.grid = with(peake, list(AREA = seq(min(AREA), na.rm=TRUE), max(AREA),na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq((min(AREA), na.rm=TRUE), (max(AREA),na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq((min(AREA), na.rm=TRUE), (max(AREA),na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq((min(AREA), na.rm=TRUE), (max(AREA),na.rm=TRUE), len=100))))
head(newdata1)
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA))+
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
peake.grid = with(peake, list(AREA = seq(min(AREA), max(AREA), len=100)))
newdata1=emmeans(peake.glm1, ~AREA, at=peake.grid, type='response') %>%  ##look at the prob of the prediction and the L confidence level
as.data.frame
head(newdata1)
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL), ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
scale_x_log10()+
scale_y_log10()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
peake.grid = with(peake, list(AREA = seq((min(AREA), na.rm=TRUE), (max(AREA),na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq((min(AREA) na.rm=TRUE), (max(AREA),na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq((min(AREA) na.rm=TRUE), (max(AREA) na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq(min(AREA, na.rm=TRUE), max(AREA, na.rm=TRUE), len=100)))
peake.grid = with(peake, list(AREA = seq(min(AREA), max(AREA), len=100)))
peake.grid = with(peake, list(AREA = seq(min(AREA, na.rm=TRUE), max(AREA, na.rm=TRUE), len=100)))
newdata1=emmeans(peake.glm1, ~AREA, at=peake.grid, type='response') %>%  ##look at the prob of the prediction and the L confidence level
as.data.frame
head(newdata1)
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=log(response), x=log(AREA)))+
geom_ribbon(aes(ymin=log(asymp.LCL), ymax=log(asymp.UCL)), fill='blue', alpha=0.3)+
geom_line()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
scale_x_log10()+
scale_y_log10()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='silver', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
scale_x_log10()+
scale_y_log10()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='gold', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
scale_x_log10()+
scale_y_log10()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='gold', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV), position=jitter)+
scale_x_log10()+
scale_y_log10()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='gold', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV), position='jitter')+
scale_x_log10()+
scale_y_log10()+
theme_classic()
ggplot(newdata1, aes(y=response, x=AREA))+
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='gold', alpha=0.3)+
geom_line()+
geom_point(data=peake, aes(y=INDIV))+
scale_x_log10()+
scale_y_log10()+
theme_classic()
loyn = read_csv('../data/loyn.csv', trim_ws=TRUE)
glimpse(loyn)
loyn.lm <- lm(loyn)
loyn.lm
autoplot(loyn.lm, which=1:6)
autoplot(loyn.lm, which=1:6)
scatterplotMatrix(~ABUND+DIST+LDIST+AREA+GRAZE+ALT+YR.ISOL, data=loyn,
diagonal = list(method='boxplot'))
scatterplotMatrix(~ABUND+log(DIST)+log(LDIST)+log(AREA)+GRAZE+ALT+YR.ISOL, data=loyn,
diagonal = list(method='boxplot'))
loyn = loyn %>% mutate(fGRAZE=facto(GRAZE))
loyn = loyn %>% mutate(fGRAZE=factor(GRAZE))
loyn
loyn = loyn %>% mutate(fGRAZE=factor(GRAZE))
scatterplotMatrix(~ABUND+log(DIST)+log(LDIST)+log(AREA)+GRAZE+ALT+YR.ISOL, data=loyn,
diagonal = list(method='boxplot'))
loyn.lm <- lm(ABUND~scale(log(DIST))+scale(log(LDIST))+scale(log(AREA))+fGRAZE + scale(ALT)+scale(YR.ISOL), data=loyn)
autoplot(loyn.lm, within=1:6)
autoplot(loyn.lm, which=1:6)
vif(loyn.lm)
loyn.resid <- simulateResiduals(loyn.lm)
plot(loyn.resid)
ggplot(data=NULL, aes(x=resid(loyn.lm, x=scale(log(loyn$AREA)))))
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$AREA)))))
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$AREA))))
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$AREA)))) +
geom_point()
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$AREA)))) +
geom_point()+
loyn.resid <- simulateResiduals(loyn.lm)
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$AREA)))) +
geom_point()+
geom_smooth()
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$GRAZE)))) +
geom_point()+
geom_smooth()
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$GRAZE)))) +
geom_boxplot()+
geom_point()
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(loyn$GRAZE))) +
geom_boxplot()+
geom_point()
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=loyn$GRAZE)) +
geom_boxplot()+
geom_point()
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=loyn$fGRAZE)) +
geom_boxplot()+
geom_point()
ggplot(data=NULL, aes(y=as.vector(resid(loyn.lm)), x=scale(log(loyn$DIST)))) +
geom_point()
plot(loyn.resid)
plot(loyn.resid)
polis.grid = with(polis, list(RATIO = seq(min(RATIO, na.rm=TRUE), max(RATIO,na.rm=TRUE), len=100)))
$class
loyn.resid$scaledResiduals
DHARMa::$class
DHARMa$class
loyn.resid$class
plot(allEffects(loyn.lm, residuals=T), type='response')
plot_grid(plot_model(loyn.lm, type='eff'))
plot_model(loyn.lm, type='est', transform = 'c')
plot_grid(plot_model(loyn.lm, type='eff'))
plot(allEffects(loyn.lm, residuals=T), type='response')
plot_model(loyn.lm, type='est', transform = 'c')
plot_grid(plot_model(loyn.lm, type='eff'))
plot_grid(plot_model(loyn.lm))
plot_grid(plot_model(loyn.lm, type='eff'))
plot_model(loyn.lm, type='est', transform = 'I')
plot_model(loyn.lm, type='est', transform = 'c')
summary(loyn.lm)
tudy(loyn.lm, conf.int=TRUE)
tidy(loyn.lm, conf.int=TRUE)
dredge(loyn.lm, rank="AICc")
dredge(loyn.lm, rank="AIC")
loyn.lm = update(loyn/lm, na.action=na.fail)
loyn.lm = update(loyn.lm, na.action=na.fail)
dredge(loyn.lm, rank="AICc")
##average the first few models to
##have the weight to get the weighted average of the effect
##need to decide a cut off, so how many models to include
loyn.av <- model.avg(dredge(loyn.lm, rank="AICc"),
subset=delta<=10)
loyn.av
summary(loyn.av)
loyn.lm1 <- update (loyn.lm, .~scale(log(DIST) + scale(log(LDIST)))
loyn.lm1 <- update (loyn.lm, .~scale(log(DIST) + scale(log(LDIST)))
loyn.lm2 <- update (loyn.lm, .~scale(log(AREA) + fGRAZE + scale(TR.ISOL)
loyn.lm2 <- update (loyn.lm, .~scale(log(AREA) + fGRAZE + scale(TR.ISOL))
loyn.lm2 <- update (loyn.lm, .~scale(log(AREA) + fGRAZE + scale(YR.ISOL))
loyn.lm2 <- update (loyn.lm, .~scale(log(AREA) + fGRAZE + scale(YR.ISOL)))
loyn.lm2 <- update (loyn.lm, .~scale(log(AREA) + fGRAZE + scale(YR.ISOL)))
loyn.lm1 <- update (loyn.lm, .~scale(log(DIST)) + scale(log(LDIST)))
loyn.lm2 <- update (loyn.lm, .~scale(log(AREA)) + fGRAZE + scale(YR.ISOL))
loyn.lm3 <- update (loyn.lm, .~scale(log(AREA)) + fGRAZE)
loyn.lm4 <- update (loyn.lm, .~scale(ALT))
loyn.null <- update (loyn.lm, .~1)
AICc(loyn.lm, loyn.lm1, loyn.lm2, loyn.lm3, loyn.lm4, loyn.null)
loyn.grid = with(loyn, list(fGRAZE = levels (fGRAZE),
AREA = seq(min(AREA), max(AREA), len=100)))
loyn.grid <- with(loyn, list(fGRAZE = levels (fGRAZE),
AREA = seq(min(AREA), max(AREA), len=100)))
newdata2=emmeans(loyn.lm, ~AREA, at=loyn.grid, type='response') %>%
as.data.frame
head(newdata2)
newdata2=emmeans(loyn.lm3, ~AREA, at=loyn.grid, type='response') %>%
as.data.frame
newdata2=emmeans(loyn.lm3, ~AREA|fGRAZE, at=loyn.grid %>%
head(newdata2)
newdata2=emmeans(loyn.lm3, ~AREA|fGRAZE, at=loyn.grid %>% as.data.frame
newdata2=emmeans(loyn.lm3, ~AREA|fGRAZE, at=loyn.grid %>% as.data.frame
newdata2=emmeans(loyn.lm3, ~AREA|fGRAZE, at=loyn.grid) %>% as.data.frame
newdata2=emmeans(loyn.lm3, ~AREA|fGRAZE, at=loyn.grid) %>% as.data.frame
head(newdata2)
ggplot(newdata2, aes(y=emmeans, x=AREA)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), fill='blue', alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), fill='blue', alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.3) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.9) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.1) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
scale_y_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
geom_point() +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
geom_point(data=loyn, aes(y=emmean)) +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
geom_point(data=newdata2, aes(y=emmean)) +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
geom_point(data=newdata2, aes(y=emmean)) +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
geom_point(data=loyn, aes(y=emmean)) +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
geom_point(data=loyn, aes(y=ABUND, colour=fGRAZE)) +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_point(data=loyn, aes(y=ABUND, colour=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
scale_x_log10() +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_point(data=loyn, aes(y=ABUND, colour=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
scale_x_log10(labels=scales::comma) +
theme_classic()
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_point(data=loyn, aes(y=ABUND, colour=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
scale_x_log10(labels=scales::comma) +
scale_y_continuous('Abndance')
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_point(data=loyn, aes(y=ABUND, colour=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
scale_x_log10(labels=scales::comma) +
scale_y_continuous('Abundance')
ggplot(newdata2, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_point(data=loyn, aes(y=ABUND, colour=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
scale_x_log10(labels=scales::comma) +
scale_y_continuous('Abundance')+
theme_classic()
loyn %>% group_by(fGRAZE) %>% do({data.frame(AREA=seq(min(AREA), max(AREA), len=100))})
loyn %>% group_by(fGRAZE) %>% do({data.frame(AREA=seq(min(AREA), max(AREA), len=100))})  loyn
loyn %>% group_by(fGRAZE) %>% do({data.frame(AREA=seq(min(AREA), max(AREA), len=100))})  loyn
loyn %>% group_by(fGRAZE) %>% do({data.frame(AREA=seq(min(.$AREA), max(.$AREA), len=100))})
summary(loyn/lm3)
summary(loyn.lm3)
loyn.glm <- glm(ABUND~scale(log(AREA)) * fGRAZE, data=loyn, family=gaussian(link='log'))
loyn.glm1 <- glm(ABUND~scale(log(AREA)) + fGRAZE, data=loyn, family=gaussian(link='log'))
AICc(loyn.glm, loyn.glm1)
anova(loyn.glm, loyn.glm1, test='Chisq')
summary(loyn.glm)
plot(allEffects(loyn.glm))
summary(loyn.glm),
plot(allEffects(loyn.glm))
summary(loyn.glm)
newdata2=emmeans(loyn.glm, ~AREA|fGRAZE, at=loyn.grid,
type='response') %>% as.data.frame
newdata3=emmeans(loyn.glm, ~AREA|fGRAZE, at=loyn.grid,
type='response') %>% as.data.frame
head(newdata3)
ggplot(newdata3, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=lower.CL, ymax=upper.CL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata3, aes(y=emmean, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.2) +
geom_line() +
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10()+
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10()+
scale_x_log10()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10()+
scale_x_log10()+
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10()+
scale_x_log10('Abundance')+
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10('Abundance')+
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10(labels=scales::comma)+
theme_classic()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10(labels=scales::comma)+
theme_classic()+
scale_colour_viridis_d()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10(labels=scales::comma)+
theme_classic()+
scale_colour_viridis_d()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10(labels=scales::comma)+
theme_classic()+
scale_colour_viridis_d()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10(labels=scales::comma)+
theme_classic()+
scale_colour_viridis_c()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10(labels=scales::comma)+
theme_classic()+
scale_colour_viridis_d()
ggplot(newdata3, aes(y=response, x=AREA, colour=fGRAZE, fill=fGRAZE)) +
geom_ribbon(aes(ymin=asymp.LCL, ymax=asymp.UCL), colour=NA, alpha=0.3) +
geom_line() +
scale_y_log10('Abundance')+
scale_x_log10(labels=scales::comma)+
theme_classic()+
scale_colour_viridis_d() +  #fill diff colour
scale_fill_viridis_d()
summary(loyn.glm)
library(pscl)
exp(-3.0037)
plogis(-3.0037)
quinn.zip <- zeroinfl(RECRUITS ~ DENSITY*SEASON | SEASON, data=quinn, dist='poisson')
library(readr)
quinn <- read_csv("quinn.csv")
View(quinn)
library(pscl)
quinn.zip <- zeroinfl(RECRUITS ~ DENSITY*SEASON | SEASON, data=quinn, dist='poisson')
DENSITYLow:SEASONWinter
plogis(-2.16)
plogis(-0.216)
